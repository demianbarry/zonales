function Source(a,b){this.name=a?a:"";this.checked=b!==undefined?b:false}function Tag(a,b){this.name=a?a:"";this.checked=b!==undefined?b:false}function Filters(){this.sources=new Array();this.temp="";this.tags=new Array()}function ZContext(P,m,A){var t=new Filters();var G=new Array();var F="";var S="";var r="";var p="";var N="";var e="";var B="";var H="";this.order=H;var d=P;var K=m;var k=A;this.setSearchKeyword=function(V){d.emit("addKeywordToZCtx",{sessionId:K,keyword:V},function(){p=V})};this.getSearchKeyword=function(){return p};var b=function b(V){d.emit("getCtx",K,function(W){console.log(JSON.stringify(W));W.filters.sources.each(function(X){t.sources.push(new Source(X.name,X.checked))});W.filters.tags.each(function(X){t.tags.push(new Tag(X.name,X.checked))});t.temp=W.filters.temp;G=W.zTabs;F=W.zTab;H=W.order;S=W.selZone;r=W.efZone;p=W.searchKeyword;if(!S){S=""}N=e=S.replace(/_/g," ").capitalize();V()})};this.initZCtx=b;this.setSelectedZone=function z(V,X,W,Y,Z){if(V==""&&W==""){S="";N=""}else{if(V==""&&W!=""){S=W;N=Y;V=W}else{S=V;N=X}}d.emit("setSelectedZoneToCtx",{sessionId:K,zone:V},function(){if(Z){Z()}return(this)})};this.zcGetContext=function J(){return this};this.zcSetProvinceName=function q(V){B=V};this.zcGetProvinceName=function a(){return B};this.zcAddSource=function y(W){var V=M(this,W);if(V==-1){var X=new Source();X.name=W;X.checked=true;t.sources.push(X)}else{t.sources[V].checked=true}d.emit("addSourceToZCtx",{sessionId:K,source:W},function(Y){})};this.zcUncheckSource=function w(W){var V=M(this,W);if(V==-1){var X=new Source();X.name=W;X.checked=false;t.sources.push(X)}else{t.sources[V].checked=false}d.emit("uncheckSourceFromZCtx",{sessionId:K,source:W},function(Y){})};this.zcAddTag=function C(V){var W=n(this,V);if(W==-1){var X=new Tag();X.name=V;X.checked=true;t.tags.push(X)}else{t.tags[W].checked=true}d.emit("addTagToZCtx",{sessionId:K,tag:V})};this.zcUncheckTag=function R(V){var W=n(this,V);if(W==-1){var X=new Tag();X.name=V;X.checked=false;t.tags.push(X)}else{t.tags[W].checked=false}d.emit("uncheckTagFromthis",{sessionId:K,tag:V},function(Y){})};this.zcGetTags=function I(){return t.tags};this.zcGetCheckedTags=function Q(){var V=new Array();t.tags.each(function(W){if(W.checked){V.push(W.name)}});return V};this.zcGetCheckedSources=function O(){var V=new Array();t.sources.each(function(W){if(W.checked){V.push(W.name)}});return V};this.zcSearchSource=function M(W,X){if(t.sources.length>0){for(var V=0;V<t.sources.length;V++){if(t.sources[V].name==X){return V}}}return -1};this.zcSearchTag=function n(W,X){if(t.tags.length>0){for(var V=0;V<t.tags.length;V++){if(t.tags[V].name==X){return V}}}return -1};this.getAllZones=function x(V){d.emit("getZones",true,function(W){V(W);return(this)})};this.getProvincias=function h(V){d.emit("getZoneByFilters",{type:"provincia"},function(W){V(W);return(this)})};this.getZonesByProvincia=function l(V,W){d.emit("getZoneByFilters",{parent:V},function(X){W(X);return(this)})};this.getZoneById=function c(W,V){d.emit("getZoneByFilters",{id:W},function(X){V(X[0]);return(this)})};this.getIdByZone=function v(V,W){console.log("dentro de getIdByZone con "+V);d.emit("getZoneByFilters",{extendedString:V},function(X){W(X[0].id);return(this)})};this.getPlaces=function U(V,W){d.emit("getExtendedString",V,function(X){W(X);return(this)})};this.zcGetSelectedZoneName=function g(){return N};this.zcGetEfectiveZoneName=function f(){return e};this.zcSetTemp=function s(V){t.temp=V;d.emit("setTempToCtx",{sessionId:K,temp:V},function(W){})};this.zcSetTab=function j(V){F=V;if(d){d.emit("setTabToCtx",{sessionId:K,tab:V},function(W){})}};this.zcGetFilters=function i(){return t};this.zcGetTemp=function o(){return t.temp};this.zcGetZTab=function L(){return F};this.zcGetZTabs=function E(){return G};this.zcGetZone=function u(){return S};this.zcGetOrder=function(){return H};this.zcSetOrder=function(V,W){if(d){d.emit("setOrderToCtx",{sessionId:K,order:V},function(X){H=V;if(typeof W==="function"){W()}})}};this.zcAddTab=function D(V){if(G.indexOf(V)==-1){G.push(V);if(d){d.emit("addTabToCtx",{sessionId:K,tab:V},function(W){})}return true}else{return false}};this.zcRemoveTab=function T(V){if(G.indexOf(V)!=-1&&G.length>1){G.splice(G.indexOf(V),1);if(d){d.emit("removeTabToCtx",{sessionId:K,tab:V},function(W){})}return true}else{return false}}};